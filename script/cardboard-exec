#!/bin/sh
# Make sure deps are available and run a Cardboard command.

set -e

cd $(dirname "$0")/..

BIN=.bundle/binstubs
CARDBOARD=$BIN/cardboard
SCRIPT=$(basename "$0")

rm -rf .bundle/{binstubs,config}

bundle install --binstubs "$BIN" --path .bundle --quiet &&
  "$CARDBOARD" bootstrap && exec "$CARDBOARD" "$SCRIPT" "$@"
